# ğŸ§­ äº§å“æ–‡æ¡£

## ä¸€ã€äº§å“æ¦‚è¿°

**åç§°ï¼š** ç¥å¼ƒä¹‹åœ°å­˜æ¡£å¤‡ä»½ç®¡ç†å™¨ï¼ˆGodForsaken Save Backup Managerï¼‰
**ç‰ˆæœ¬ï¼š** v1.0
**ç›®æ ‡ç”¨æˆ·ï¼š** ã€Šç¥å¼ƒä¹‹åœ°ã€‹æ­£å¼ç‰ˆç©å®¶
**ç›®æ ‡ï¼š**

* æä¾›é«˜å®‰å…¨æ€§ã€é«˜æ•ˆç‡çš„æœ¬åœ°å­˜æ¡£å¤‡ä»½ä¸æ¢å¤ç³»ç»Ÿ
* å¯è§†åŒ–ç®¡ç†å†å²å­˜æ¡£
* é¢„é˜²è¯¯æ“ä½œï¼ˆå°¤å…¶æ˜¯è¯¯æ¢å¤ï¼‰å¸¦æ¥çš„å­˜æ¡£ä¸¢å¤±é—®é¢˜

---

## äºŒã€ä¸»è¦åŠŸèƒ½

| åŠŸèƒ½            | è¯´æ˜                                                                |
| ------------- | ----------------------------------------------------------------- |
| **æ‰‹åŠ¨å¤‡ä»½**      | å°†å½“å‰å­˜æ¡£å¤åˆ¶ä¸º `game_save_my_bak\manual\YYYY-MM-DD_HH-MM-SS` æ ¼å¼ç›®å½•ã€‚             |
| **è‡ªåŠ¨å¤‡ä»½ï¼ˆæ¢å¤å‰ï¼‰** | æ¢å¤å­˜æ¡£æ—¶ï¼Œè‹¥å½“å‰å­˜æ¡£æœªå­˜åœ¨å¤‡ä»½ï¼Œåˆ™è‡ªåŠ¨åˆ›å»ºäº `game_save_my_bak\auto\YYYY-MM-DD_HH-MM-SS`ã€‚ |
| **å¤‡æ³¨ç³»ç»Ÿ**      | ç”¨æˆ·å¯åœ¨å†å²å­˜æ¡£åˆ—è¡¨ä¸­ä¸ºå¤‡ä»½æ·»åŠ /ä¿®æ”¹å¤‡æ³¨ã€‚è‡ªåŠ¨å¤‡ä»½å°†è‡ªåŠ¨æ ‡æ³¨ `[è‡ªåŠ¨å¤‡ä»½]`ã€‚                                |
| **å†å²å­˜æ¡£åˆ—è¡¨**    | æ˜¾ç¤ºæ‰€æœ‰å¤‡ä»½ï¼ˆå«è‡ªåŠ¨å¤‡ä»½ï¼‰ï¼ŒæŒ‰å­˜æ¡£ä¿®æ”¹æ—¶é—´å€’åºæ’åˆ—ã€‚å¤‡æ³¨æ å³ç”¨äºåŒºåˆ†æ‰‹åŠ¨/è‡ªåŠ¨å¤‡ä»½ã€‚                        |
| **æœ€å¤§å†å²æ•°é™åˆ¶**   | è¶…è¿‡é…ç½®ä¸Šé™æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æœ€æ—©çš„å¤‡ä»½ã€‚                                                |
| **æ¢å¤ä¿æŠ¤**      | æ¢å¤å‰è‡ªåŠ¨æ£€æµ‹å½“å‰æ¸¸æˆè¿›ç¨‹çŠ¶æ€ã€æ‰§è¡Œå¿…è¦çš„ä¿æŠ¤æ€§è‡ªåŠ¨å¤‡ä»½ã€‚                                     |
| **æ„å¤–æ¢å¤ä¿æŠ¤**      | æ¢å¤å‰æ£€æµ‹ç›®æ ‡å¤‡ä»½ä¸å½“å‰å­˜æ¡£çš„æ–‡ä»¶ä¿®æ”¹æ—¶é—´å·®å€¼ï¼Œå¦‚æœè¶…è¿‡æ¢å¤ç¡®è®¤é˜ˆå€¼ï¼Œåˆ™æé†’ç”¨æˆ·ç¡®è®¤ï¼Œä»¥é˜²æ­¢è¿›è¡Œäº†æ„æ–™ä¹‹å¤–çš„å­˜æ¡£æ¢å¤    |
| **é…ç½®ç³»ç»Ÿ**      | å¯è®¾ç½®è·¯å¾„ã€æœ€å¤§æ•°é‡ã€æ¢å¤ç¡®è®¤é˜ˆå€¼ã€è‡ªåŠ¨å¯åŠ¨æ¸¸æˆç­‰é€‰é¡¹ï¼›æ‰€æœ‰é…ç½®ä¸å¤‡æ³¨æŒä¹…åŒ–ã€‚                                  |
| **è‡ªåŠ¨å¯åŠ¨æ¸¸æˆ**    | æ¢å¤å®Œæˆåå¯é€‰è‡ªåŠ¨æ‰§è¡Œ `steam://rungameid/3419290`ã€‚                          |

---

## ä¸‰ã€UI è®¾è®¡

### ä¸»ç•Œé¢å¸ƒå±€

```
+-------------------------------------------------------------+
| [å¤‡ä»½å­˜æ¡£] [æ¢å¤å­˜æ¡£] [è®¾ç½®]            |
|-------------------------------------------------------------|
| å†å²å­˜æ¡£åˆ—è¡¨ï¼ˆæŒ‰ä¿®æ”¹æ—¶é—´å€’åºï¼‰                             |
|-------------------------------------------------------------|
| æ—¶é—´              | å¤‡æ³¨                     | æ“ä½œ           |
|-------------------------------------------------------------|
| 2025-11-06_20-05-15 | [è‡ªåŠ¨å¤‡ä»½] æ¢å¤å‰è‡ªåŠ¨ç”Ÿæˆ | [æ¢å¤] [åˆ é™¤] |
| 2025-11-06_18-55-22 | è…åŒ–å‰å¤‡ä»½               | [æ¢å¤] [åˆ é™¤] |
| 2025-11-06_18-30-47 | é¦–æ¬¡å¤‡ä»½                 | [æ¢å¤] [åˆ é™¤] |
+-------------------------------------------------------------+
```

---

### è®¾ç½®ç•Œé¢

```
+------------------------------------------+
| å­˜æ¡£è·¯å¾„: [_________________________] [é€‰æ‹©] |
| å¤‡ä»½è·¯å¾„: [_________________________] [é€‰æ‹©] |
| æœ€å¤§å†å²æ•°é‡: [ 20 ]                       |
| æ¢å¤ç¡®è®¤é˜ˆå€¼(åˆ†é’Ÿ): [ 20 ]                 |
| è‡ªåŠ¨å¯åŠ¨æ¸¸æˆ [âˆš]                           |
|------------------------------------------|
| [ä¿å­˜è®¾ç½®] [å–æ¶ˆ]                         |
+------------------------------------------+
```

---

## å››ã€é…ç½®æ–‡ä»¶è®¾è®¡

è·¯å¾„ï¼š
`{backup_root_path}\backup_manager_config.json`
ï¼ˆé»˜è®¤ä½ç½®ï¼š`%USERPROFILE%\AppData\LocalLow\InsightStudio\GodForsakenRelease\game_save_my_bak\backup_manager_config.json`ï¼‰

### JSON ç¤ºä¾‹

```json
{
  "game_save_path": "C:\\Users\\User\\AppData\\LocalLow\\InsightStudio\\GodForsakenRelease\\game_save",
  "backup_root_path": "C:\\Users\\User\\AppData\\LocalLow\\InsightStudio\\GodForsakenRelease\\game_save_my_bak",
  "last_backup": "",
  "max_history": 20,
  "restore_confirm_threshold_minutes": 20,
  "auto_launch_game": true,
  "notes": {
    "2025-11-06_18-30-47": "è…åŒ–å‰å¤‡ä»½",
    "2025-11-06_19-10-03": "[è‡ªåŠ¨å¤‡ä»½] æ¢å¤å‰è‡ªåŠ¨ç”Ÿæˆ"
  }
}
```

---

## äº”ã€é€»è¾‘æµç¨‹

### æ‰‹åŠ¨å¤‡ä»½

```
â†’ æ£€æµ‹ GodForsaken.exe æ˜¯å¦è¿è¡Œ
â†’ è¯»å– ProfileBrief.ssp ä¿®æ”¹æ—¶é—´
â†’ æ¯”è¾ƒæ˜¯å¦å·²å­˜åœ¨ç›¸åŒæ—¶é—´æˆ³çš„å¤‡ä»½
â†’ è‹¥æ— é‡å¤ï¼š
     åˆ›å»ºç›®å½• YYYY-MM-DD_HH-MM-SS
     å¤åˆ¶æ–‡ä»¶
     æ›´æ–° last_backup
â†’ æ ¹æ®è®¾ç½®æ˜¯å¦å¯åŠ¨æ¸¸æˆ
â†’ åˆ·æ–° UI åˆ—è¡¨
```

### æ¢å¤å­˜æ¡£

```
â†’ æ£€æµ‹ GodForsaken.exe æ˜¯å¦è¿è¡Œ
â†’ è¯»å–å½“å‰ ProfileBrief.ssp ä¿®æ”¹æ—¶é—´
â†’ è®¡ç®—ç›®æ ‡å¤‡ä»½å­˜æ¡£çš„ä¿®æ”¹æ—¶é—´ä¸å½“å‰å­˜æ¡£ä¿®æ”¹æ—¶é—´çš„å·®å€¼ï¼ˆåˆ†é’Ÿï¼‰
â†’ å¦‚æœå·®å€¼è¶…è¿‡é…ç½®çš„é˜ˆå€¼ï¼ˆrestore_confirm_threshold_minutesï¼‰ï¼Œåˆ™å¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†ï¼Œç”¨æˆ·ç¡®è®¤åæ‰ç»§ç»­ï¼Œå¦åˆ™ä¸­æ­¢
â†’ è‹¥æœªå­˜åœ¨å¯¹åº”å¤‡ä»½ï¼š
     è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡è‡ªåŠ¨å¤‡ä»½ï¼ˆå¤‡æ³¨ [è‡ªåŠ¨å¤‡ä»½]ï¼‰
â†’ æ‰§è¡Œæ¢å¤æ“ä½œï¼ˆè¦†ç›– game_saveï¼‰
â†’ æ›´æ–° last_backup
â†’ æ ¹æ®è®¾ç½®æ˜¯å¦å¯åŠ¨æ¸¸æˆ
â†’ åˆ·æ–° UI åˆ—è¡¨
```

---

# ğŸ§± æ¶æ„æ–‡æ¡£ï¼ˆåˆ†å±‚ç‰ˆï¼‰

## ä¸€ã€é¡¹ç›®ç›®å½•ç»“æ„

```
godforsaken-save-manager/
â”‚
â”œâ”€ pyproject.toml
â”œâ”€ README.md
â”œâ”€ src/
â”‚  â”œâ”€ godforsaken_save_manager/
â”‚  â”‚  â”œâ”€ __init__.py
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ core/                    # ä¸šåŠ¡é€»è¾‘æ ¸å¿ƒå±‚
â”‚  â”‚  â”‚  â”œâ”€ backup_manager.py     # å¤‡ä»½/æ¢å¤/åˆ é™¤é€»è¾‘
â”‚  â”‚  â”‚  â”œâ”€ config_manager.py     # é…ç½®ç®¡ç†ï¼ˆå«é»˜è®¤å€¼é€»è¾‘ï¼‰
â”‚  â”‚  â”‚  â”œâ”€ process_checker.py    # æ¸¸æˆè¿›ç¨‹æ£€æµ‹
â”‚  â”‚  â”‚  â”œâ”€ file_operations.py    # æ–‡ä»¶å¤åˆ¶ã€æ¯”å¯¹ã€æ¸…ç†ç­‰æ“ä½œ
â”‚  â”‚  â”‚  â””â”€ backup_entry.py       # æ•°æ®ç»“æ„å®šä¹‰ï¼ˆBackupEntryï¼‰
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ ui/                      # ç•Œé¢å±‚
â”‚  â”‚  â”‚  â”œâ”€ main_window.py        # ä¸»çª—å£ï¼ˆå†å²åˆ—è¡¨ä¸æŒ‰é’®ï¼‰
â”‚  â”‚  â”‚  â”œâ”€ settings_window.py    # è®¾ç½®çª—å£
â”‚  â”‚  â”‚  â”œâ”€ resources.qrc         # å›¾æ ‡èµ„æº
â”‚  â”‚  â”‚  â””â”€ style.qss             # æ ·å¼è¡¨
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ common/                  # é€šç”¨æ”¯æŒå±‚
â”‚  â”‚  â”‚  â”œâ”€ constants.py          # å¸¸é‡å®šä¹‰ï¼ˆè·¯å¾„æ¨¡æ¿ã€æ–‡ä»¶åç­‰ï¼‰
â”‚  â”‚  â”‚  â””â”€ helpers.py            # å…¬å…±å°å‡½æ•°ï¼ˆæ—¶é—´æˆ³æ ¼å¼åŒ–ã€æ—¥å¿—ç­‰ï¼‰
â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€ main.py                  # ç¨‹åºå…¥å£
â”‚  â”‚
â”‚  â””â”€ tests/                      # å•å…ƒæµ‹è¯•
â”‚     â”œâ”€ test_backup_manager.py
â”‚     â”œâ”€ test_config_manager.py
â”‚     â””â”€ test_file_operations.py
```

---

## äºŒã€æ¨¡å—è¯´æ˜

### `core/backup_entry.py`

å®šä¹‰æ•°æ®ç»“æ„ï¼š

```python
@dataclass
class BackupEntry:
    path: Path
    timestamp: str        # "2025-11-06_18-30-47"
    note: str
    profile_mtime: datetime
```

---

### `core/config_manager.py`

è´Ÿè´£åŠ è½½ä¸ä¿å­˜ `backup_manager_config.json`ï¼Œå¹¶å¡«å……é»˜è®¤å€¼ã€‚

```python
DEFAULTS = {
    "game_save_path": "%USERPROFILE%\\AppData\\LocalLow\\InsightStudio\\GodForsakenRelease\\game_save",
    "backup_root_path": "%USERPROFILE%\\AppData\\LocalLow\\InsightStudio\\GodForsakenRelease\\game_save_my_bak",
    "last_backup": "",
    "max_history": 20,
    "restore_confirm_threshold_minutes": 20,
    "auto_launch_game": True,
    "notes": {}
}
```

æä¾›æ¥å£ï¼š

```python
def load_config() -> dict
def save_config(config: dict)
def ensure_defaults(config: dict) -> dict
```

---

### `core/backup_manager.py`

æ ¸å¿ƒé€»è¾‘ç±»ï¼š

```python
class BackupManager:
    def backup(self, note: str = "", auto: bool = False) -> str
    def restore(self, target_path: Path)
    def delete(self, target_path: Path)
    def list_backups(self) -> List[BackupEntry]
    def get_time_diff(self, target_path: Path) -> float  # è¿”å›æ—¶é—´å·®å€¼ï¼ˆåˆ†é’Ÿï¼‰
```

å†…éƒ¨è‡ªåŠ¨ï¼š

* æ£€æµ‹æ¸¸æˆè¿›ç¨‹ï¼ˆ`process_checker`ï¼‰
* è‡ªåŠ¨è°ƒç”¨ `file_operations.copy_directory`
* æ›´æ–° `config_manager`
* ç»´æŠ¤æœ€å¤§æ•°é‡é™åˆ¶

---

### `core/process_checker.py`

æ£€æµ‹æ¸¸æˆè¿›ç¨‹ï¼š

```python
import psutil

def is_game_running() -> bool:
    for proc in psutil.process_iter(['name']):
        if proc.info['name'] == "GodForsaken.exe":
            return True
    return False
```

---

### `core/file_operations.py`

å°è£…æ–‡ä»¶æ“ä½œï¼š

```python
def copy_directory(src: Path, dst: Path)
def remove_directory(path: Path)
def get_profile_timestamp(path: Path) -> datetime
```

---

### `ui/main_window.py`

PySide6 ä¸»ç•Œé¢é€»è¾‘ï¼š

* è¡¨æ ¼æ˜¾ç¤ºå†å²å­˜æ¡£ï¼ˆæ—¶é—´ã€å¤‡æ³¨ã€æ“ä½œæŒ‰é’®ï¼‰
* ç»‘å®šæŒ‰é’®äº‹ä»¶ï¼ˆå¤‡ä»½ã€æ¢å¤ã€åˆ é™¤ã€è®¾ç½®ï¼‰
* æ¢å¤å‰æ£€æŸ¥æ—¶é—´å·®å€¼å¹¶ç¡®è®¤

---

### `ui/settings_window.py`

æä¾›ï¼š

* è·¯å¾„é€‰æ‹©ï¼ˆQFileDialogï¼‰
* æ•°å€¼è¾“å…¥ï¼ˆæœ€å¤§å†å²æ•°é‡ã€æ¢å¤ç¡®è®¤é˜ˆå€¼ï¼‰
* å¤é€‰æ¡†ï¼ˆè‡ªåŠ¨å¯åŠ¨æ¸¸æˆï¼‰
* ä¿å­˜é…ç½®å¹¶åˆ·æ–°ä¸»ç•Œé¢

---

### `common/helpers.py`

å¸¸ç”¨è¾…åŠ©ï¼š

```python
def format_timestamp(dt: datetime) -> str:
    return dt.strftime("%Y-%m-%d_%H-%M-%S")
```

---

## ä¸‰ã€Poetry + Nuitka

### `pyproject.toml`

```toml
[tool.poetry]
name = "godforsaken-save-manager"
version = "1.0.0"
description = "A save management tool for GodForsaken"
authors = ["ä¸ƒå¤œå¬é›ª <example@example.com>"]
packages = [{ include = "godforsaken_save_manager", from = "src" }]

[tool.poetry.dependencies]
python = "^3.11"
PySide6 = "^6.7.0"
psutil = "^5.9.8"

[tool.poetry.scripts]
godforsaken-save-manager = "godforsaken_save_manager.main:main"
```

---

### Nuitka ç¼–è¯‘å‘½ä»¤

```bash
poetry run nuitka \
  --onefile \
  --enable-plugin=pyside6 \
  --include-data-dir=src/godforsaken_save_manager/ui/resources=resources \
  --output-filename=GodForsakenSaveManager.exe \
  src/godforsaken_save_manager/main.py
```

---

## âœ… ç‰¹ç‚¹æ€»ç»“

| ç±»åˆ«   | ä¼˜ç‚¹                                    |
| ---- | ------------------------------------- |
| æ¶æ„   | åˆ†å±‚æ¸…æ™°ï¼š`core`ï¼ˆä¸šåŠ¡ï¼‰ã€`ui`ï¼ˆç•Œé¢ï¼‰ã€`common`ï¼ˆå·¥å…·ï¼‰ |
| UI   | ç®€æ´ï¼šä»…å±•ç¤ºæ—¶é—´ä¸å¤‡æ³¨ï¼Œé¿å…è§†è§‰å™ªéŸ³                    |
| å®‰å…¨æ€§  | è‡ªåŠ¨å¤‡ä»½ä¿æŠ¤æœºåˆ¶ + è¿›ç¨‹æ£€æµ‹ + æ—¶é—´å·®å€¼ç¡®è®¤æé†’            |
| é…ç½®   | è‡ªåŠ¨åº”ç”¨é»˜è®¤å€¼ + å¯ç¼–è¾‘å­˜å‚¨è·¯å¾„ + å¯è‡ªå®šä¹‰æ¢å¤ç¡®è®¤é˜ˆå€¼       |
| ç¼–è¯‘   | ä½¿ç”¨ Nuitka å®ç°é«˜æ€§èƒ½å•æ–‡ä»¶å¯æ‰§è¡Œäº§ç‰©               |
| å¯ç»´æŠ¤æ€§ | æ¯ä¸ªæ¨¡å—èŒè´£å•ä¸€ï¼Œå¯ç‹¬ç«‹æµ‹è¯•                        |
